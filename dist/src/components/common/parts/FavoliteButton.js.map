{"version":3,"file":"FavoliteButton.js","sourceRoot":"","sources":["../../../../../src/components/common/parts/FavoliteButton.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,KAAK,EAAE,EAAE,SAAS,EAAE,QAAQ,EAAM,MAAM,OAAO,CAAA;AACtD,OAAO,EAAE,eAAe,EAAE,MAAM,gCAAgC,CAAA;AAChE,OAAO,EAAE,OAAO,EAAE,MAAM,mCAAmC,CAAA;AAE3D,OAAO,SAAS,MAAM,0BAA0B,CAAA;AAG9C,IAAA,WAAW,GAIT,SAAS,YAJA,EACX,cAAc,GAGZ,SAAS,eAHG,EACd,cAAc,GAEZ,SAAS,eAFG,EACd,cAAc,GACZ,SAAS,eADG,CACH;AAEb,IAAM,cAAc,GAAiB,UAAA,KAAK;IAChC,IAAA,OAAO,GAAiB,KAAK,QAAtB,EAAE,UAAU,GAAK,KAAK,WAAV,CAAU;IAC/B,IAAA,KAA4B,QAAQ,CAAc,EAAE,CAAC,EAApD,SAAS,QAAA,EAAE,YAAY,QAA6B,CAAA;IACrD,IAAA,KAAkC,QAAQ,CAAC,CAAC,CAAC,EAA5C,YAAY,QAAA,EAAE,eAAe,QAAe,CAAA;IACnD,IAAM,cAAc,GAAG,UAAO,KAAoC;;;;;oBAChE,KAAK,CAAC,OAAO,EAAE,CAAA;oBACf,KAAK,CAAC,cAAc,EAAE,CAAA;oBACtB,IAAI,CAAC,OAAO,EAAE;wBACZ,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAA;wBAC1B,sBAAM;qBACP;oBACD,IAAI,CAAC,UAAU,EAAE;wBACf,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAA;wBACxB,sBAAM;qBACP;yBAEG,CAAA,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,MAAM,GAAG,CAAC,CAAA,EAAjC,wBAAiC;oBACnC,cAAc,CAAC,SAAS,CAAC,EAAE,CAAC,CAAA;oBAC5B,YAAY,CAAC,EAAE,CAAC,CAAA;oBAChB,eAAe,CAAC,YAAY,GAAG,CAAC,CAAC,CAAA;;wBAEd,qBAAM,cAAc,CAAC,KAAK,CAAC,EAAA;;oBAAxC,EAAE,GAAW,SAA2B;oBAC9C,IAAI,CAAC,EAAE,EAAE;wBACP,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAA;wBACxB,sBAAM;qBACP;oBACD,YAAY,YAAG,EAAE,IAAA,IAAK,KAAK,EAAG,CAAA;oBAC9B,eAAe,CAAC,YAAY,GAAG,CAAC,CAAC,CAAA;;;;;SAEpC,CAAA;IAED,SAAS,CAAC;QACR,IAAI,SAAS,GAAG,KAAK,CACpB;QAAA,CAAC;;;;4BACmB,qBAAM,WAAW,CAAC,OAAO,EAAE,UAAU,CAAC,EAAA;;wBAAlD,QAAQ,GAAI,CAAA,SAAsC,CAAA,GAA1C;wBACO,qBAAM,cAAc,CAAC,UAAU,CAAC,EAAA;;wBAAhD,KAAK,GAAW,SAAgC;wBACtD,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAA;wBAClB,IAAI,CAAC,SAAS,EAAE;4BACd,IAAI,QAAQ,EAAE;gCACZ,YAAY,CAAC,QAAQ,CAAC,CAAA;gCACtB,eAAe,CAAC,KAAK,CAAC,CAAA;6BACvB;yBACF;;;;aACF,CAAC,EAAE,CAAA;QACJ,OAAO;YACL,SAAS,GAAG,IAAI,CAAA;QAClB,CAAC,CAAA;IACH,CAAC,EAAE,EAAE,CAAC,CAAA;IAEN,OAAO,CACL;QACE,6BAAK,SAAS,EAAC,iBAAiB,EAAC,OAAO,EAAE,cAAc,IACrD,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,CACnC,oBAAC,eAAe,IAAC,IAAI,EAAE,OAAO,EAAE,SAAS,EAAC,SAAS,GAAG,CACvD,CAAC,CAAC,CAAC,CACF,oBAAC,eAAe,IAAC,IAAI,EAAE,OAAO,GAAI,CACnC,CACG;QACN,iCAAM,YAAY,CAAO,CACxB,CACJ,CAAA;AACH,CAAC,CAAA;AAED,eAAe,cAAc,CAAA","sourcesContent":["import React, { useEffect, useState, FC } from \"react\"\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { faHeart } from \"@fortawesome/free-solid-svg-icons\"\nimport { Favorite, ResFavorite } from \"../../../types/favorite\"\nimport functions from \"../../../utils/functions\"\nimport { number } from \"prop-types\"\nconst {\n  getFavorite,\n  createFavorite,\n  deleteFavorite,\n  getfavoriteNum\n} = functions\n\nconst FavoliteButton: FC<Favorite> = props => {\n  const { user_id, summary_id } = props\n  const [favorites, setFavorites] = useState<ResFavorite>({})\n  const [favoritesNum, setFavoritesNum] = useState(0)\n  const handleFavorite = async (event: React.MouseEvent<HTMLElement>) => {\n    event.persist()\n    event.preventDefault()\n    if (!user_id) {\n      console.log(\"ログインしてください。\")\n      return\n    }\n    if (!summary_id) {\n      console.log(\"記事がありません。\")\n      return\n    }\n    //レンダリングさせる必要がある\n    if (Object.keys(favorites).length > 0) {\n      deleteFavorite(favorites.id)\n      setFavorites({})\n      setFavoritesNum(favoritesNum - 1)\n    } else {\n      const id: string = await createFavorite(props)\n      if (!id) {\n        console.log(\"idが存在しません\")\n        return\n      }\n      setFavorites({ id, ...props })\n      setFavoritesNum(favoritesNum + 1)\n    }\n  }\n\n  useEffect(() => {\n    let unmounted = false\n    ;(async () => {\n      const [favorite] = await getFavorite(user_id, summary_id)\n      const count: number = await getfavoriteNum(summary_id)\n      console.log(count)\n      if (!unmounted) {\n        if (favorite) {\n          setFavorites(favorite)\n          setFavoritesNum(count)\n        }\n      }\n    })()\n    return () => {\n      unmounted = true\n    }\n  }, [])\n\n  return (\n    <>\n      <div className=\"favolite-button\" onClick={handleFavorite}>\n        {Object.keys(favorites).length > 0 ? (\n          <FontAwesomeIcon icon={faHeart} className=\"clicked\" />\n        ) : (\n          <FontAwesomeIcon icon={faHeart} />\n        )}\n      </div>\n      <div>{favoritesNum}</div>\n    </>\n  )\n}\n\nexport default FavoliteButton\n"]}