{"version":3,"file":"SummaryForm.js","sourceRoot":"","sources":["../../../../../src/components/common/form/SummaryForm.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\"\nimport { useForm } from \"react-hook-form\"\nimport Input from \"./parts/Input\"\nimport Textarea from \"./parts/Textarea\"\nimport Select from \"./parts/Select\"\nimport {\n  SummaryBook,\n  ResCategory,\n  ResSubCategory\n} from \"../../../types/summary\"\nimport { CurrentUser } from \"../../../types/user\"\nimport functions from \"../../../utils/functions\"\nconst {\n  getCategories,\n  categoryLinkingSubCategory,\n  createSummary,\n  getCurrentUser\n} = functions\nconst user: CurrentUser = getCurrentUser()\n\nconst SummaryForm = () => {\n  const [values, setValues] = useState<SummaryBook>({})\n  const [categories, setCategories] = useState<ResCategory[]>([])\n  const [subCategories, setSubCategories] = useState<ResSubCategory[]>([])\n  const [isSelectCategory, setIsSelectCategory] = useState<boolean>(false)\n\n  const { register, handleSubmit, errors, formState } = useForm<SummaryBook>({\n    mode: \"onChange\"\n  })\n\n  const handleInputChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    event.persist()\n    const target = event.target\n    const value = target.type === \"checkbox\" ? target.checked : target.value\n    const name = target.name\n    setValues({ ...values, [name]: value })\n  }\n\n  const handleTextareaChange = (\n    event: React.ChangeEvent<HTMLTextAreaElement>\n  ) => {\n    event.persist()\n    const target = event.target\n    const value = target.value\n    const name = target.name\n    setValues({ ...values, [name]: value })\n  }\n\n  const handleSelectChange = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    event.persist()\n    const target = event.target\n    const value = target.value\n    const name = target.name\n    setValues({ ...values, [name]: value })\n    setIsSelectCategory(true)\n    subCategorySelect(value)\n  }\n\n  const onSubmit = (event: React.MouseEvent) => {\n    console.log(values)\n    event.persist()\n    event.preventDefault()\n\n    if (window.confirm(\"記事を作成しますか？\")) {\n      createSummary(values)\n    }\n  }\n\n  const subCategorySelect = async (categoryId?: string) => {\n    const subCate = await categoryLinkingSubCategory(categoryId)\n    setSubCategories(subCate)\n  }\n\n  useEffect(() => {\n    let unmounted = false\n    ;(async () => {\n      let cate_result = await getCategories()\n\n      if (!unmounted) {\n        console.log(\"called-first\")\n        setCategories(cate_result)\n        setValues({ ...values, [\"user_id\"]: user.uid })\n      }\n    })()\n    return () => {\n      unmounted = true\n    }\n  }, [])\n\n  return (\n    <>\n      <form className=\"form-table\">\n        <Input\n          title=\"本のタイトル\"\n          name=\"title\"\n          placeholder=\"人を動かす\"\n          required={true}\n          onChange={handleInputChange}\n        />\n        {errors.title && \"作者名は1文字以上、20文字以下でなければなりません。\"}\n        <Textarea\n          title=\"本の内容\"\n          name=\"content\"\n          required={true}\n          onChange={handleTextareaChange}\n        />\n        <Select\n          title=\"本のカテゴリー\"\n          name=\"category\"\n          required={true}\n          dataList={categories}\n          onChange={handleSelectChange}\n        />\n        {isSelectCategory && (\n          <Select\n            title=\"本のサブカテゴリー\"\n            name=\"sub_category\"\n            onChange={handleSelectChange}\n            dataList={subCategories}\n          />\n        )}\n        <Input\n          title=\"筆者\"\n          name=\"author\"\n          placeholder=\"要約太郎\"\n          onChange={handleInputChange}\n        />\n        <Input\n          title=\"値段\"\n          name=\"price\"\n          placeholder=\"4000円\"\n          onChange={handleInputChange}\n        />\n        <Input\n          title=\"評価(5段階)\"\n          name=\"review\"\n          placeholder=\"星４\"\n          onChange={handleInputChange}\n        />\n        <Input\n          title=\"商品リンク\"\n          name=\"product_links\"\n          placeholder=\"https://~\"\n          onChange={handleInputChange}\n        />\n\n        <div className=\"btn-area mgt-2 inline\">\n          <button className=\"_btn submit\" type=\"submit\" onClick={onSubmit}>\n            作成する\n          </button>\n          {/* <button className=\"_btn submit\" type=\"submit\">\n            編集する\n          </button> */}\n          <button className=\"_btn remove\" type=\"button\">\n            削除する\n          </button>\n        </div>\n      </form>\n    </>\n  )\n}\n\nexport default SummaryForm\n"]}